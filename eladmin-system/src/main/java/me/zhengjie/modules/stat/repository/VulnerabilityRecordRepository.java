package me.zhengjie.modules.stat.repository;

import me.zhengjie.modules.stat.domain.VulnerabilityRecord;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.Pageable;
import org.springframework.data.jpa.repository.JpaRepository;
import org.springframework.data.jpa.repository.JpaSpecificationExecutor;

import java.time.LocalDateTime;

public interface VulnerabilityRecordRepository extends JpaRepository<VulnerabilityRecord, Long>, JpaSpecificationExecutor<VulnerabilityRecord> {
    
    /**
     * 根据创建时间范围查询
     */
    Page<VulnerabilityRecord> findByCreatedAtBetween(LocalDateTime startTime, LocalDateTime endTime, Pageable pageable);
    
    /**
     * 多字段关键字搜索
     */
    Page<VulnerabilityRecord> findBySystemNameContainingIgnoreCaseOrOrgNameContainingIgnoreCaseOrVulnSourceContainingIgnoreCaseOrVulnTypeContainingIgnoreCase(
        String systemName, String orgName, String vulnSource, String vulnType, Pageable pageable);
    
    /**
     * 根据发现时间范围查询
     */
    Page<VulnerabilityRecord> findByFoundTimeBetween(LocalDateTime startTime, LocalDateTime endTime, Pageable pageable);
    
    /**
     * 根据漏洞等级查询
     */
    Page<VulnerabilityRecord> findByVulnLevel(String vulnLevel, Pageable pageable);
    
    /**
     * 根据系统名称查询
     */
    Page<VulnerabilityRecord> findBySystemNameContainingIgnoreCase(String systemName, Pageable pageable);
    
    /**
     * 根据组织名称查询
     */
    Page<VulnerabilityRecord> findByOrgNameContainingIgnoreCase(String orgName, Pageable pageable);
}