CREATE TABLE abnormal_event_stat (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY COMMENT '主键ID',

    stat_time DATETIME NOT NULL COMMENT '统计时间',

    outbound INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '外联行为数量',
    outside_to_inside INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '外对内行为数量',
    lateral_move INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '横向移动行为数量',
    other INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '其他异常行为数量',

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间'
) COMMENT='异常事件类型统计表';


CREATE TABLE outbound_ip_stat (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY COMMENT '主键ID',

    location VARCHAR(100) NOT NULL COMMENT '地理位置，例如北京、加州',
    is_domestic BOOLEAN NOT NULL COMMENT '是否为国内IP，1表示是，0表示否',
    stat_time DATETIME NOT NULL COMMENT '统计时间',

    ip_count INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '该位置外联IP数量',

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间'
) COMMENT='外联IP地理位置统计表';


CREATE TABLE vulnerability_fix_stat (
    id BIGINT UNSIGNED AUTO_INCREMENT PRIMARY KEY COMMENT '主键ID',

    stat_time DATE NOT NULL COMMENT '统计时间',

    fixed_count INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '已修复漏洞数量',
    unfixed_count INT UNSIGNED NOT NULL DEFAULT 0 COMMENT '未修复漏洞数量',

    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '创建时间',
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新时间',

    UNIQUE KEY uniq_stat_time (stat_time)
) COMMENT='漏洞修复情况统计表';


